<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Tools for Variable Selection &amp; Inference • selectInferToolkit</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Tools for Variable Selection &amp; Inference">
<meta name="description" content="This is a package designed to make the process of post-selection inference easier.">
<meta property="og:description" content="This is a package designed to make the process of post-selection inference easier.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">selectInferToolkit</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="articles/selectInferToolkit.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="selectinfertoolkit">selectInferToolkit<a class="anchor" aria-label="anchor" href="#selectinfertoolkit"></a>
</h1></div>
<!-- badges: start -->

<p>The <code>selectInferToolkit</code> package aims to addresses a critical challenge in modern statistical modeling: <strong>conducting valid inference after performing model selection.</strong> In the era of big data and complex regression problems, researchers often employ model selection procedures like stepwise regression or penalized methods (e.g., lasso) to identify important variables. However, classical statistical inference assumes the model was chosen <em>a priori</em>—independent of the data. When this assumption is violated, standard statistical tests and confidence intervals can become overly optimistic, leading to unreliable conclusions.<code>selectInferToolkit</code> provides a user-friendly framework in R to facilitate post-selection inferential methods.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of selectInferToolkit like so:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"petersonR/selectInferToolkit"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="package-overview">Package Overview<a class="anchor" aria-label="anchor" href="#package-overview"></a>
</h2>
<p><code>selectInferToolkit</code> offers a comprehensive suite of tools, covering both model selection and the crucial post-selection inference steps.</p>
<div class="section level3">
<h3 id="model-selection-methods">Model Selection Methods<a class="anchor" aria-label="anchor" href="#model-selection-methods"></a>
</h3>
<p>The package supports two broad classes of popular model selection techniques:</p>
<ul>
<li>
<strong>Stepwise Regression:</strong> Implement forward, backward, and bidirectional stepwise regression. User can use either the <strong>Akaike Information Criterion (AIC)</strong> or the <strong>Bayesian Information Criterion (BIC)</strong> as selection criteria, leveraging the <code>stepAIC</code> function from the <code>MASS</code> package.</li>
<li>
<strong>Penalized Regression:</strong> Perform lasso, ridge, and elastic net regressions using the powerful <code>ncvreg</code> or <code>glmnet</code> packages. <code>selectInferToolkit</code> simplifies the process of obtaining models associated with either <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub><annotation encoding="application/x-tex">\lambda_{min}</annotation></semantics></math> or <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mrow><mn>1</mn><mi>s</mi><mi>e</mi></mrow></msub><annotation encoding="application/x-tex">\lambda_{1se}</annotation></semantics></math>.
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub><annotation encoding="application/x-tex">\lambda_{min}</annotation></semantics></math> represents the regularization parameter <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math> that minimizes the cross-validation error, aiming for the best predictive performance.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mrow><mn>1</mn><mi>s</mi><mi>e</mi></mrow></msub><annotation encoding="application/x-tex">\lambda_{1se}</annotation></semantics></math> is a more conservative choice, selecting the largest <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math> where the cross-validation error is within one standard error of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub><annotation encoding="application/x-tex">\lambda_{min}</annotation></semantics></math>. This often results in a sparser, more parsimonious model.</li>
</ul>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="post-selection-inference-methods">Post-Selection Inference Methods<a class="anchor" aria-label="anchor" href="#post-selection-inference-methods"></a>
</h3>
<p>The core contribution of <code>selectInferToolkit</code> lies in its ability to provide straightforward implementations of three distinct post-selection inference methods, applicable after you’ve performed model selection using one of the methods above:</p>
<ol style="list-style-type: decimal">
<li>
<strong>UPSI</strong>: A baseline approach that performs no adjustment for the selection process. We refer to this as “unadjusted post-selection inference”, or “UPSI” for short. Others refer to this as “hybrid-OLS” (in the Gaussian outcome case).</li>
<li>
<strong>Bootstrap:</strong> A non-parametric bootstrap method that resamples data to account for selection uncertainty.</li>
<li>
<strong>Selective Inference:</strong> A theoretically grounded approach, currently available for lasso and forward stepwise selection through integration with the <code>selectiveInference</code> package.</li>
<li>
<strong>PIPE</strong>: [currently experimental]</li>
</ol>
</div>
<div class="section level3">
<h3 id="handling-non-selected-variables">Handling Non-Selected Variables<a class="anchor" aria-label="anchor" href="#handling-non-selected-variables"></a>
</h3>
<p><code>selectInferToolkit</code> is explicity in its handling of non-selections, which can be set to be:</p>
<ul>
<li>
<strong>Ignored:</strong> Treating non-selected variables as irrelevant.</li>
<li>
<strong>Confident (point-mass) nulls:</strong> Assuming these variables have exactly zero effect.</li>
<li>
<strong>Uncertain nulls:</strong> Aim to make inference on all variables but without the assumption that non-selections certainly have a null effect</li>
</ul>
</div>
<div class="section level3">
<h3 id="bootstrapping-considerations">Bootstrapping considerations<a class="anchor" aria-label="anchor" href="#bootstrapping-considerations"></a>
</h3>
<p>In bootstrapping, the above methods of handling nonselections are similar but slightly altered.</p>
<p>We allow the user to specify their <code>inference_target</code> as either <code>"selections"</code> or <code>"all"</code>, <code>debias</code> varies whether the coefficients are re-fit after selection prior to bootstrapped aggregation, and <code>estimation_data</code> as either <code>"in-sample"</code> or <code>"out-of-sample"</code> which facilitates the estimation of the coefficients on the ‘left-out’ data after the model has been fit within a bootstrapped sample (similar to sample spliting).</p>
<p>More details on the bootstrapping approach are forthcoming.</p>
</div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>Let’s say you are wanting to predict gas mileage based on all variables in the <code>mtcars</code> data set.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://petersonr.github.io/selectInferToolkit/">selectInferToolkit</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: broom</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"mtcars"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_full</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_full</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = mpg ~ ., data = mtcars)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -3.4506 -1.6044 -0.1196  1.2193  4.6271 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)  </span></span>
<span><span class="co">#&gt; (Intercept) 12.30337   18.71788   0.657   0.5181  </span></span>
<span><span class="co">#&gt; cyl         -0.11144    1.04502  -0.107   0.9161  </span></span>
<span><span class="co">#&gt; disp         0.01334    0.01786   0.747   0.4635  </span></span>
<span><span class="co">#&gt; hp          -0.02148    0.02177  -0.987   0.3350  </span></span>
<span><span class="co">#&gt; drat         0.78711    1.63537   0.481   0.6353  </span></span>
<span><span class="co">#&gt; wt          -3.71530    1.89441  -1.961   0.0633 .</span></span>
<span><span class="co">#&gt; qsec         0.82104    0.73084   1.123   0.2739  </span></span>
<span><span class="co">#&gt; vs           0.31776    2.10451   0.151   0.8814  </span></span>
<span><span class="co">#&gt; am           2.52023    2.05665   1.225   0.2340  </span></span>
<span><span class="co">#&gt; gear         0.65541    1.49326   0.439   0.6652  </span></span>
<span><span class="co">#&gt; carb        -0.19942    0.82875  -0.241   0.8122  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 2.65 on 21 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.869,  Adjusted R-squared:  0.8066 </span></span>
<span><span class="co">#&gt; F-statistic: 13.93 on 10 and 21 DF,  p-value: 3.793e-07</span></span></code></pre></div>
<p>Hmm, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mn>2</mn></msup><annotation encoding="application/x-tex">R^2</annotation></semantics></math> is high but nothing is “significant”. What is going on? The model is probably over-specified. Let’s use <code>selectInferToolkit</code> to narrow in on what we think the most important factors are. The <code>step_ic</code> function can do forwards and backwards selection via AIC by default.</p>
<div class="section level3">
<h3 id="stepwise-selection">Stepwise selection<a class="anchor" aria-label="anchor" href="#stepwise-selection"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_aic</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/select_stepwise_ic.html">select_stepwise_ic</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">mtcars</span>, penalty <span class="op">=</span> <span class="st">"AIC"</span><span class="op">)</span> </span>
<span><span class="va">fit_aic</span></span>
<span><span class="co">#&gt; Stepwise IC-based selector</span></span>
<span><span class="co">#&gt; 3 of 10 variables selected: hp, cyl, wt </span></span>
<span><span class="co">#&gt; Meta information: family=gaussian, select_factors_together=TRUE, penalty=AIC, direction=forward </span></span>
<span><span class="co">#&gt; Default `infer()` method: boot</span></span></code></pre></div>
<p>Functions prefixed with <code>select_</code> create a <code>selector</code> class object. We can pass <code>selector</code> objects to <code>coef</code>, <code>predict</code>, and <code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code> functions:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit_aic</span><span class="op">)</span></span>
<span><span class="co">#&gt; (Intercept)          wt         cyl          hp </span></span>
<span><span class="co">#&gt;   20.090625   -3.098748   -1.681654   -1.236744</span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">fit_aic</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 11 × 3</span></span>
<span><span class="co">#&gt;    term        selected  coef</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 (Intercept)        1 20.1 </span></span>
<span><span class="co">#&gt;  2 cyl                1 -1.68</span></span>
<span><span class="co">#&gt;  3 disp               0  0   </span></span>
<span><span class="co">#&gt;  4 hp                 1 -1.24</span></span>
<span><span class="co">#&gt;  5 drat               0  0   </span></span>
<span><span class="co">#&gt;  6 wt                 1 -3.10</span></span>
<span><span class="co">#&gt;  7 qsec               0  0   </span></span>
<span><span class="co">#&gt;  8 vs                 0  0   </span></span>
<span><span class="co">#&gt;  9 am                 0  0   </span></span>
<span><span class="co">#&gt; 10 gear               0  0   </span></span>
<span><span class="co">#&gt; 11 carb               0  0</span></span></code></pre></div>
<p>So we find that AIC selects <code>wt</code>, <code>cyl</code>, and <code>hp</code>. But where are the p-values?!</p>
<p>This is where post-selection inference comes in; p-values that do not adjust for the selective process will be too small. Again, we call this “unadjusted post-selection inference” (or UPSI, for short).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_aic_infer_upsi</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/infer.html">infer_upsi</a></span><span class="op">(</span><span class="va">fit_aic</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="va">fit_aic_infer_upsi</span></span>
<span><span class="co">#&gt; Unadjusted Post-Selection Inference (UPSI) inference applied post Stepwise IC-based Selection </span></span>
<span><span class="co">#&gt; 3 of 10 variables selected. </span></span>
<span><span class="co">#&gt; Nonselections were considered ignored </span></span>
<span><span class="co">#&gt; Meta information: none </span></span>
<span><span class="co">#&gt; Median CI length = 3; mean = 2.9; max = 3.9</span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">fit_aic_infer_upsi</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">selected</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 4 × 7</span></span>
<span><span class="co">#&gt;   term        selected  coef estimate ci_low ci_high  p_value</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 (Intercept)        1 20.1     20.1   19.2   21.0   9.94e-28</span></span>
<span><span class="co">#&gt; 2 cyl                1 -1.68    -1.68  -3.61   0.247 9.85e- 2</span></span>
<span><span class="co">#&gt; 3 hp                 1 -1.24    -1.24  -2.83   0.359 1.40e- 1</span></span>
<span><span class="co">#&gt; 4 wt                 1 -3.10    -3.10  -4.52  -1.68  1.99e- 4</span></span></code></pre></div>
<p>Thus, <code>wt</code> is significant! We know this confidence interval may be biased and too precise, as we’ve used the data both to select the model and now are using the same data to perform inference (UPSI!). What if we wanted to adjust our uncertainty quantification for the selective process?</p>
<p>Each selection process has a default <code>infer</code> method that is, for the most part, not an UPSI method. The default for stepwise selection via information criteria is bootstrapping. The code below is equivalent to calling <code>infer_boot</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">fit_aic_infer_boot</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/infer.html">infer</a></span><span class="op">(</span><span class="va">fit_aic</span>, data <span class="op">=</span> <span class="va">mtcars</span>, B <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">fit_aic_infer_boot</span></span>
<span><span class="co">#&gt; Bootstrap inference applied post Stepwise IC-based Selection </span></span>
<span><span class="co">#&gt; 3 of 10 variables selected. </span></span>
<span><span class="co">#&gt; Nonselections were considered N/A </span></span>
<span><span class="co">#&gt; Meta information: B=100, inference_target=selections, debias=TRUE, estimation_data=in-sample </span></span>
<span><span class="co">#&gt; Median CI length = 7.8; mean = 7.1; max = 9.7</span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">fit_aic_infer_boot</span><span class="op">)</span> </span>
<span><span class="co">#&gt; # A tibble: 11 × 7</span></span>
<span><span class="co">#&gt;    term        selected  coef estimate ci_low ci_high prop_selected</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;         &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 (Intercept)        1 20.1    20.1    18.7    21.7           1   </span></span>
<span><span class="co">#&gt;  2 cyl                1 -1.68   -0.357  -4.19    3.99          0.51</span></span>
<span><span class="co">#&gt;  3 disp               0  0      NA      NA      NA            NA   </span></span>
<span><span class="co">#&gt;  4 hp                 1 -1.24   -1.42   -5.70    1.66          0.5 </span></span>
<span><span class="co">#&gt;  5 drat               0  0      NA      NA      NA            NA   </span></span>
<span><span class="co">#&gt;  6 wt                 1 -3.10   -3.21   -8.05    1.64          0.88</span></span>
<span><span class="co">#&gt;  7 qsec               0  0      NA      NA      NA            NA   </span></span>
<span><span class="co">#&gt;  8 vs                 0  0      NA      NA      NA            NA   </span></span>
<span><span class="co">#&gt;  9 am                 0  0      NA      NA      NA            NA   </span></span>
<span><span class="co">#&gt; 10 gear               0  0      NA      NA      NA            NA   </span></span>
<span><span class="co">#&gt; 11 carb               0  0      NA      NA      NA            NA</span></span></code></pre></div>
<p>These results are less promising. Here we can also use a wrapper for <code>selectiveInference</code> method:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_aic_SI</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/infer.html">infer_selective</a></span><span class="op">(</span><span class="va">fit_aic</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="va">fit_aic_SI</span> </span>
<span><span class="co">#&gt; Selective inference applied post Stepwise IC-based Selection </span></span>
<span><span class="co">#&gt; 3 of 10 variables selected. </span></span>
<span><span class="co">#&gt; Nonselections were considered ignored </span></span>
<span><span class="co">#&gt; Meta information: none </span></span>
<span><span class="co">#&gt; Median CI length = Inf; mean = Inf; max = Inf</span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">fit_aic_SI</span><span class="op">)</span> </span>
<span><span class="co">#&gt; # A tibble: 11 × 7</span></span>
<span><span class="co">#&gt;    term        selected  coef estimate ci_low ci_high p_value</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 (Intercept)        1 20.1     NA      NA     NA     NA    </span></span>
<span><span class="co">#&gt;  2 cyl                1 -1.68     1.68 -Inf     38.0    0.235</span></span>
<span><span class="co">#&gt;  3 disp               0  0       NA      NA     NA     NA    </span></span>
<span><span class="co">#&gt;  4 hp                 1 -1.24     1.24  -32.2  Inf      0.795</span></span>
<span><span class="co">#&gt;  5 drat               0  0       NA      NA     NA     NA    </span></span>
<span><span class="co">#&gt;  6 wt                 1 -3.10     3.10  -13.2    7.59   0.224</span></span>
<span><span class="co">#&gt;  7 qsec               0  0       NA      NA     NA     NA    </span></span>
<span><span class="co">#&gt;  8 vs                 0  0       NA      NA     NA     NA    </span></span>
<span><span class="co">#&gt;  9 am                 0  0       NA      NA     NA     NA    </span></span>
<span><span class="co">#&gt; 10 gear               0  0       NA      NA     NA     NA    </span></span>
<span><span class="co">#&gt; 11 carb               0  0       NA      NA     NA     NA</span></span></code></pre></div>
<p>Here we see that after adjusting for the selective process, we are unable to claim significance of any of these effects (and have quite large CIs).</p>
<p>Lastly, as stated above for each post-selection inference method, we provide three approaches to handling non-selections: <code>ignored</code> (ignoring them), <code>confident_nulls</code> (treating them as confident (point-mass) degenerate nulls at zero), and <code>uncertain_nulls</code> (treating them as uncertain). For details about each of theses methods, see the package vignette.</p>
</div>
<div class="section level3">
<h3 id="penalized-regression">Penalized regression<a class="anchor" aria-label="anchor" href="#penalized-regression"></a>
</h3>
<div class="section level4">
<h4 id="lasso-via-glmnet">Lasso via glmnet<a class="anchor" aria-label="anchor" href="#lasso-via-glmnet"></a>
</h4>
<p>We can also try selecting the most important factors are by penalized models. We can fit the lasso with cross validation and selects coefficients associated with the <code>best</code> predicting model (default, i.e. <code>lambda.min</code>) or the most <code>compact</code> model that predicts about as well as the best model, i.e. <code>lambda.1se</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span></span>
<span><span class="va">fit_lso</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/select_glmnet.html">select_glmnet</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span> </span>
<span><span class="va">fit_lso</span> </span>
<span><span class="co">#&gt; Penalized `glmnet`-based selector</span></span>
<span><span class="co">#&gt; 4 of 10 variables selected: am, hp, cyl, wt </span></span>
<span><span class="co">#&gt; Meta information: family=gaussian, lambda=best, lambda_used=0.654, cv_info=list(...), ellipses=list(...) </span></span>
<span><span class="co">#&gt; Default `infer()` method: selective</span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">fit_lso</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 11 × 3</span></span>
<span><span class="co">#&gt;    term        selected     coef</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 (Intercept)        1 20.1    </span></span>
<span><span class="co">#&gt;  2 cyl                1 -1.59   </span></span>
<span><span class="co">#&gt;  3 disp               0  0      </span></span>
<span><span class="co">#&gt;  4 hp                 1 -0.879  </span></span>
<span><span class="co">#&gt;  5 drat               0  0      </span></span>
<span><span class="co">#&gt;  6 wt                 1 -2.72   </span></span>
<span><span class="co">#&gt;  7 qsec               0  0      </span></span>
<span><span class="co">#&gt;  8 vs                 0  0      </span></span>
<span><span class="co">#&gt;  9 am                 1  0.00672</span></span>
<span><span class="co">#&gt; 10 gear               0  0      </span></span>
<span><span class="co">#&gt; 11 carb               0  0</span></span></code></pre></div>
<p>The lasso also selects the same 3 variables. The lasso alone does not provide any p-value or CI to do inference, but UPSIs aside we can again perform a (questionable) hybrid inferential process where ordinary least squares theory is used for inference as though we never used the data for selection.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_lasso_infer_upsi</span> <span class="op">&lt;-</span><span class="fu"><a href="reference/infer.html">infer_upsi</a></span><span class="op">(</span><span class="va">fit_lso</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">fit_lasso_infer_upsi</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 11 × 7</span></span>
<span><span class="co">#&gt;    term        selected     coef estimate ci_low ci_high   p_value</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 (Intercept)        1 20.1       20.1   19.2    21.0    5.23e-27</span></span>
<span><span class="co">#&gt;  2 cyl                1 -1.59      -1.33  -3.37    0.709  2.12e- 1</span></span>
<span><span class="co">#&gt;  3 disp               0  0         NA     NA      NA     NA       </span></span>
<span><span class="co">#&gt;  4 hp                 1 -0.879     -1.71  -3.54    0.123  7.86e- 2</span></span>
<span><span class="co">#&gt;  5 drat               0  0         NA     NA      NA     NA       </span></span>
<span><span class="co">#&gt;  6 wt                 1 -2.72      -2.55  -4.31   -0.786  8.60e- 3</span></span>
<span><span class="co">#&gt;  7 qsec               0  0         NA     NA      NA     NA       </span></span>
<span><span class="co">#&gt;  8 vs                 0  0         NA     NA      NA     NA       </span></span>
<span><span class="co">#&gt;  9 am                 1  0.00672    0.738 -0.672   2.15   3.14e- 1</span></span>
<span><span class="co">#&gt; 10 gear               0  0         NA     NA      NA     NA       </span></span>
<span><span class="co">#&gt; 11 carb               0  0         NA     NA      NA     NA</span></span></code></pre></div>
<p>These results should look familiar: since the model selected by lasso is the same as that selected by stepwise AIC, the UPSI inference method is identical; <code>wt</code> is still seemingly significant.</p>
<p><em>Selective inference</em></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_lasso_infer_SI</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/infer.html">infer_selective</a></span><span class="op">(</span><span class="va">fit_lso</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">fit_lasso_infer_SI</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 11 × 7</span></span>
<span><span class="co">#&gt;    term        selected     coef estimate  ci_low ci_high   p_value</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 (Intercept)        1 20.1       NA       NA     NA     NA       </span></span>
<span><span class="co">#&gt;  2 cyl                1 -1.59      -1.33  -Inf      0.213  0.0147  </span></span>
<span><span class="co">#&gt;  3 disp               0  0         NA       NA     NA     NA       </span></span>
<span><span class="co">#&gt;  4 hp                 1 -0.879     -1.71    -2.35 Inf      0.947   </span></span>
<span><span class="co">#&gt;  5 drat               0  0         NA       NA     NA     NA       </span></span>
<span><span class="co">#&gt;  6 wt                 1 -2.72      -2.55  -Inf     -2.22   0.000395</span></span>
<span><span class="co">#&gt;  7 qsec               0  0         NA       NA     NA     NA       </span></span>
<span><span class="co">#&gt;  8 vs                 0  0         NA       NA     NA     NA       </span></span>
<span><span class="co">#&gt;  9 am                 1  0.00672    0.738 -Inf      0.504  0.981   </span></span>
<span><span class="co">#&gt; 10 gear               0  0         NA       NA     NA     NA       </span></span>
<span><span class="co">#&gt; 11 carb               0  0         NA       NA     NA     NA</span></span></code></pre></div>
<p>Here we see that after adjusting for the selective process with selective inference, we are able to assert a significant effect of <code>wt</code> even after the selective process. The CI for this term is only slightly wide than in the full model.</p>
<p><em>Bootstrapping + debiasing</em></p>
<p>If we debias our bootrapped estimates, we no longer are “confident” that a non-selection is akin to a coefficient of zero, thereby treating non-selections as “uncertain nulls”.</p>
<p>This may be the case if we’re interesting in making inferences for all variables, including those not selected by the prime model using full data. To obtain the bootstrap distribution of each <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>β</mi><mo accent="true">̂</mo></mover><mi>j</mi></msub><annotation encoding="application/x-tex">\hat{\beta}_j</annotation></semantics></math> we proceed as follows: For each B iterations, we re sample the data with replacement, apply the same model selection method to the re sampled data, and save the coefficients of selected variables. For any variable not selected in a given bootstrap sample, we regress the model residuals on the each non-selected variables separately to get the beta estimates for non-selections. By doing so, we’re trying to explain the residual variance by variables that were not selected by model selection method. This process will produces a bootstrap distribution for all <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math> variables, allowing us to calculate CIs by using the quantiles of these distributions.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">fit_lasso_infer_boot</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/boot.html">infer_boot</a></span><span class="op">(</span><span class="va">fit_lso</span>, data <span class="op">=</span> <span class="va">mtcars</span>, B <span class="op">=</span> <span class="fl">100</span>, inference_target <span class="op">=</span> <span class="st">"all"</span>, debias <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">fit_lasso_infer_boot</span><span class="op">)</span> </span>
<span><span class="co">#&gt; # A tibble: 11 × 7</span></span>
<span><span class="co">#&gt;    term        selected     coef estimate ci_low ci_high prop_selected</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;         &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 (Intercept)        1 20.1       20.1   19.3    21.1            1   </span></span>
<span><span class="co">#&gt;  2 cyl                1 -1.59      -0.542 -3.21    3.51           0.9 </span></span>
<span><span class="co">#&gt;  3 disp               0  0          1.28  -1.06    4.97           0.09</span></span>
<span><span class="co">#&gt;  4 hp                 1 -0.879     -1.23  -3.40    1.32           0.82</span></span>
<span><span class="co">#&gt;  5 drat               0  0          0.616 -0.541   2.91           0.44</span></span>
<span><span class="co">#&gt;  6 wt                 1 -2.72      -2.61  -5.34   -0.626          1   </span></span>
<span><span class="co">#&gt;  7 qsec               0  0          0.910 -1.19    2.93           0.11</span></span>
<span><span class="co">#&gt;  8 vs                 0  0          0.157 -1.49    2.48           0.23</span></span>
<span><span class="co">#&gt;  9 am                 1  0.00672    0.881 -0.599   2.47           0.43</span></span>
<span><span class="co">#&gt; 10 gear               0  0          0.393 -1.32    3.10           0.06</span></span>
<span><span class="co">#&gt; 11 carb               0  0         -0.885 -2.72    0.926          0.51</span></span></code></pre></div>
<p>With this approach, we see that the <code>wt</code> has a CI which does not intersect zero, indicating a significant effect.</p>
<p>Compare these to the results if <code>debias = FALSE</code>:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">fit_lasso_infer_boot</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/boot.html">infer_boot</a></span><span class="op">(</span><span class="va">fit_lso</span>, data <span class="op">=</span> <span class="va">mtcars</span>, B <span class="op">=</span> <span class="fl">100</span>, inference_target <span class="op">=</span> <span class="st">"all"</span>, debias <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">fit_lasso_infer_boot</span><span class="op">)</span> </span>
<span><span class="co">#&gt; # A tibble: 11 × 7</span></span>
<span><span class="co">#&gt;    term        selected     coef estimate ci_low ci_high prop_selected</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;         &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 (Intercept)        1 20.1     20.1     19.3    21.0            1   </span></span>
<span><span class="co">#&gt;  2 cyl                1 -1.59    -1.25    -2.89    0              0.9 </span></span>
<span><span class="co">#&gt;  3 disp               0  0       -0.0580  -0.755   0              0.09</span></span>
<span><span class="co">#&gt;  4 hp                 1 -0.879   -0.862   -2.20    0              0.82</span></span>
<span><span class="co">#&gt;  5 drat               0  0        0.223    0       1.19           0.44</span></span>
<span><span class="co">#&gt;  6 wt                 1 -2.72    -2.43    -3.85   -0.732          1   </span></span>
<span><span class="co">#&gt;  7 qsec               0  0        0.0624   0       0.558          0.11</span></span>
<span><span class="co">#&gt;  8 vs                 0  0        0.0691   0       0.811          0.23</span></span>
<span><span class="co">#&gt;  9 am                 1  0.00672  0.235    0       1.27           0.43</span></span>
<span><span class="co">#&gt; 10 gear               0  0        0.00933  0       0.141          0.06</span></span>
<span><span class="co">#&gt; 11 carb               0  0       -0.187   -0.928   0              0.51</span></span></code></pre></div>
<p>For a more in depth tutorial and examples for different methods, please consult the package vignette.</p>
</div>
<div class="section level4">
<h4 id="mcp-via-ncvreg">MCP via ncvreg<a class="anchor" aria-label="anchor" href="#mcp-via-ncvreg"></a>
</h4>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span></span>
<span><span class="va">fit_mcp</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/select_ncvreg.html">select_ncvreg</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span> </span>
<span><span class="va">fit_mcp</span> </span>
<span><span class="co">#&gt; Penalized `ncvreg`-based selector</span></span>
<span><span class="co">#&gt; 2 of 10 variables selected: qsec, wt </span></span>
<span><span class="co">#&gt; Meta information: family=gaussian, penalty=MCP, lambda=best, lambda_used=0.73, lambda_seq=list(...), cv_info=list(...), ellipses=list(...) </span></span>
<span><span class="co">#&gt; Default `infer()` method: pipe</span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">fit_mcp</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 11 × 3</span></span>
<span><span class="co">#&gt;    term        selected  coef</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 (Intercept)        1 20.1 </span></span>
<span><span class="co">#&gt;  2 cyl                0  0   </span></span>
<span><span class="co">#&gt;  3 disp               0  0   </span></span>
<span><span class="co">#&gt;  4 hp                 0  0   </span></span>
<span><span class="co">#&gt;  5 drat               0  0   </span></span>
<span><span class="co">#&gt;  6 wt                 1 -4.99</span></span>
<span><span class="co">#&gt;  7 qsec               1  1.37</span></span>
<span><span class="co">#&gt;  8 vs                 0  0   </span></span>
<span><span class="co">#&gt;  9 am                 0  0   </span></span>
<span><span class="co">#&gt; 10 gear               0  0   </span></span>
<span><span class="co">#&gt; 11 carb               0  0</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_mcp_infer_upsi</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/infer.html">infer_upsi</a></span><span class="op">(</span><span class="va">fit_mcp</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">fit_mcp_infer_upsi</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 11 × 7</span></span>
<span><span class="co">#&gt;    term        selected  coef estimate ci_low ci_high   p_value</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 (Intercept)        1 20.1     20.1  19.2     21.0   4.84e-28</span></span>
<span><span class="co">#&gt;  2 cyl                0  0       NA    NA       NA    NA       </span></span>
<span><span class="co">#&gt;  3 disp               0  0       NA    NA       NA    NA       </span></span>
<span><span class="co">#&gt;  4 hp                 0  0       NA    NA       NA    NA       </span></span>
<span><span class="co">#&gt;  5 drat               0  0       NA    NA       NA    NA       </span></span>
<span><span class="co">#&gt;  6 wt                 1 -4.99    -4.94 -5.87    -4.01  2.52e-11</span></span>
<span><span class="co">#&gt;  7 qsec               1  1.37     1.66  0.732    2.59  1.50e- 3</span></span>
<span><span class="co">#&gt;  8 vs                 0  0       NA    NA       NA    NA       </span></span>
<span><span class="co">#&gt;  9 am                 0  0       NA    NA       NA    NA       </span></span>
<span><span class="co">#&gt; 10 gear               0  0       NA    NA       NA    NA       </span></span>
<span><span class="co">#&gt; 11 carb               0  0       NA    NA       NA    NA</span></span></code></pre></div>
<p><em>Bootstrapping</em></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span></span>
<span><span class="va">fit_mcp_infer_boot</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/boot.html">infer_boot</a></span><span class="op">(</span><span class="va">fit_mcp</span>, data <span class="op">=</span> <span class="va">mtcars</span>, B <span class="op">=</span> <span class="fl">100</span>, inference_target <span class="op">=</span> <span class="st">"all"</span>, debias <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">fit_mcp_infer_boot</span><span class="op">)</span> </span>
<span><span class="co">#&gt; # A tibble: 11 × 7</span></span>
<span><span class="co">#&gt;    term        selected  coef  estimate ci_low ci_high prop_selected</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;         &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 (Intercept)        1 20.1  20.1       19.1    21.0           1   </span></span>
<span><span class="co">#&gt;  2 cyl                0  0    -1.33      -5.54    0             0.37</span></span>
<span><span class="co">#&gt;  3 disp               0  0    -0.397     -4.85    0             0.09</span></span>
<span><span class="co">#&gt;  4 hp                 0  0    -0.283     -4.74    0             0.07</span></span>
<span><span class="co">#&gt;  5 drat               0  0     0.0157     0       0             0.02</span></span>
<span><span class="co">#&gt;  6 wt                 1 -4.99 -3.24      -6.32    0             0.76</span></span>
<span><span class="co">#&gt;  7 qsec               1  1.37  0.575      0       2.13          0.45</span></span>
<span><span class="co">#&gt;  8 vs                 0  0     0          0       0             0   </span></span>
<span><span class="co">#&gt;  9 am                 0  0     0.136      0       1.73          0.12</span></span>
<span><span class="co">#&gt; 10 gear               0  0     0.000184   0       0             0.01</span></span>
<span><span class="co">#&gt; 11 carb               0  0    -0.169     -1.84    0             0.2</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span></span>
<span><span class="va">fit_mcp_infer_boot</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/boot.html">infer_boot</a></span><span class="op">(</span><span class="va">fit_mcp</span>, data <span class="op">=</span> <span class="va">mtcars</span>, B <span class="op">=</span> <span class="fl">100</span>, inference_target <span class="op">=</span> <span class="st">"all"</span>, debias <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">fit_mcp_infer_boot</span><span class="op">)</span> </span>
<span><span class="co">#&gt; # A tibble: 11 × 7</span></span>
<span><span class="co">#&gt;    term        selected  coef estimate ci_low ci_high prop_selected</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;         &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 (Intercept)        1 20.1   20.1    19.2    21.0            1   </span></span>
<span><span class="co">#&gt;  2 cyl                0  0     -1.69   -5.56    1.23           0.37</span></span>
<span><span class="co">#&gt;  3 disp               0  0     -0.0320 -4.37    2.52           0.09</span></span>
<span><span class="co">#&gt;  4 hp                 0  0     -1.16   -4.62    0.778          0.07</span></span>
<span><span class="co">#&gt;  5 drat               0  0      0.521  -0.891   1.92           0.02</span></span>
<span><span class="co">#&gt;  6 wt                 1 -4.99  -3.56   -6.28   -0.543          0.76</span></span>
<span><span class="co">#&gt;  7 qsec               1  1.37   0.912  -1.02    2.24           0.45</span></span>
<span><span class="co">#&gt;  8 vs                 0  0     -0.0734 -2.02    1.23           0   </span></span>
<span><span class="co">#&gt;  9 am                 0  0      0.915  -0.605   2.46           0.12</span></span>
<span><span class="co">#&gt; 10 gear               0  0      0.351  -1.12    2.52           0.01</span></span>
<span><span class="co">#&gt; 11 carb               0  0     -0.706  -2.19    0.385          0.2</span></span></code></pre></div>
<p><em>PIPE</em>: available for <code>ncvreg</code> only</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_mcp_infer_pipe</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/infer.html">infer_pipe</a></span><span class="op">(</span><span class="va">fit_mcp</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">fit_mcp_infer_pipe</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 11 × 7</span></span>
<span><span class="co">#&gt;    term        selected  coef estimate ci_low ci_high   p_value</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 (Intercept)        1 20.1   NA      NA      NA     NA       </span></span>
<span><span class="co">#&gt;  2 cyl                0  0     -0.423  -2.44    1.60   0.701   </span></span>
<span><span class="co">#&gt;  3 disp               0  0     -0.0843 -2.46    2.29   0.947   </span></span>
<span><span class="co">#&gt;  4 hp                 0  0     -0.423  -2.26    1.43   0.679   </span></span>
<span><span class="co">#&gt;  5 drat               0  0      0.425  -0.706   1.39   0.518   </span></span>
<span><span class="co">#&gt;  6 wt                 1 -4.99  -4.99   -5.91   -4.07   0       </span></span>
<span><span class="co">#&gt;  7 qsec               1  1.37   1.65    0.284   2.45   0.000426</span></span>
<span><span class="co">#&gt;  8 vs                 0  0      0.216  -1.37    1.77   0.811   </span></span>
<span><span class="co">#&gt;  9 am                 0  0      0.473  -0.816   1.63   0.520   </span></span>
<span><span class="co">#&gt; 10 gear               0  0      0.274  -0.731   1.15   0.658   </span></span>
<span><span class="co">#&gt; 11 carb               0  0     -0.290  -1.30    0.828  0.667</span></span></code></pre></div>
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing selectInferToolkit</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Jinal Shah <br><small class="roles"> Author </small>   </li>
<li>Ryan A Peterson <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-4650-5798" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/petersonR/selectInferToolkit/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/petersonR/selectInferToolkit/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://app.codecov.io/gh/petersonR/selectInferToolkit" class="external-link"><img src="https://codecov.io/gh/petersonR/selectInferToolkit/graph/badge.svg" alt="Codecov test coverage"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jinal Shah, Ryan A Peterson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
